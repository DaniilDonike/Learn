#kogorta 
Чтобы проще было делить пользователей на когорты, лучше составить их профили - таблицу с деталями первого посещения каждого пользователя. 

first() - возвращает первое значение в группе 
last() - возвращает последнее значение в группе 

